def smallestStringWithSwaps(s, pairs):
    parent = {i: i for i in range(len(s))}

    def find(x):
        if x != parent[x]:
            parent[x] = find(parent[x])
        return parent[x]

    def union(x, y):
        parent[find(x)] = find(y)

    for x, y in pairs:
        union(x, y)

    groups = collections.defaultdict(list)
    for i in range(len(s)):
        groups[find(i)].append(s[i])

    for key in groups:
        groups[key].sort(reverse=True)

    ans = []
    for i in range(len(s)):
        ans.append(groups[find(i)].pop())

    return ''.join(ans)
